pipeline {

    agent any

    environment {
        NEW_VERSION = "1.3.0"

        CLASS = "CLASS OF 13"

        AUTHOR = "TOLULOPE GBADAMOSI"

        BRANCH_NAME ="main"

        SERVER_CREDENTIALS = credentials('PLAY-PLAY')

        parameters {
            choice(name : 'VERSION', choices: ['1.10','1.20','1.30'], description: '')
            booleanParam(name : 'executeTests', defaultValue: 'true', description: '')
        }
    }

    stages {

        stage ("build") {

            when {
                expression {
                    params.executeTests
                }
            }

        

            steps {

                echo "I am building.."
                echo "Building ${NEW_VERSION} "
                echo "I AM ${AUTHOR}"
            }
        }

        stage ("test") {

            when {

                expression {

                    BRANCH_NAME != "master"
                }
            }

            steps {

                echo "I am testing.."
                echo "Deplyoing with ${SERVER_CREDENTIALS}"
                echo "Deploying version ${params.VERSION}"
            }
        }

        stage ("deploy") {

            steps {

                echo "I am deploying.."
            }
        }
    }
    post {
        always {
            echo "We are testing the pipeline"
            
        }

        success {

            echo "Our pipeline is successfully run"
        }

        failure {

            echo "Our pipeline failed"
        }
    }
}
